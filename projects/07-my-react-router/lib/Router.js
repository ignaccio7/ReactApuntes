import{jsx as _jsx}from"react/jsx-runtime";import{EVENTS}from"./consts";import{useState,useEffect,Children}from"react";import{match}from"path-to-regexp";import{getCurrentPath}from"./utils";export function Router(param){var children=param.children,_param_routes=param.routes,routes=_param_routes===void 0?[]:_param_routes,tmp=param.defaultComponent,DefaultComponent=tmp===void 0?function(){return _jsx("h1",{children:"404 - Not Found"})}:tmp;var _routesToUse_find;var _useState=useState(getCurrentPath()),currentPath=_useState[0],setCurrentPath=_useState[1];useEffect(function(){var onLocationChange=function(){setCurrentPath(getCurrentPath())};window.addEventListener(EVENTS.PUSHSTATE,onLocationChange);window.addEventListener(EVENTS.POPSTATE,onLocationChange);return function(){window.removeEventListener(EVENTS.PUSHSTATE,onLocationChange);window.removeEventListener(EVENTS.POPSTATE,onLocationChange)}},[]);var routeParams={};var routerFromChildren=Children.map(children,function(param){var props=param.props,type=param.type;var name=type.name;var isRoute=name==="Route";return isRoute?props:null});var routesToUse=routes.concat(routerFromChildren).filter(Boolean);var Page=(_routesToUse_find=routesToUse.find(function(param){var path=param.path;if(path===currentPath)return true;var matchUrl=match(path,{decode:decodeURIComponent});var matched=matchUrl(currentPath);if(!matched)return false;routeParams=matched.params;return true}))==null?void 0:_routesToUse_find.Component;return Page?_jsx(Page,{routeParams:routeParams}):_jsx(DefaultComponent,{routeParams:routeParams})}